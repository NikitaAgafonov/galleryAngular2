{"version":3,"file":"gallery.component.js","sourceRoot":"","sources":["gallery.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { galleryService } from './gallery.service';\r\n\r\n@Component({\r\n    selector: 'Gallery',\r\n    providers: [galleryService],\r\n    template: `\r\n        <div class=\"title\">\r\n                Gallery\r\n        </div>\r\n        <div class=\"container\">\r\n            <div class=\"gallery\">\r\n                <img *ngFor=\"let img of images; let i = index\" src=\"{{img.img.M.href}}\" (click)=\"selectPhoto(i)\" class=\"thumbnail\"/>\r\n            </div>\r\n        </div>\r\n        <popup \r\n            *ngIf=\"watching\" \r\n            [img]=\"selectedImg\" \r\n            [haveNext]=\"haveNext\"\r\n            [havePrev]=\"havePrev\"\r\n            (onClose)=\"onClose()\"\r\n            (onPrev)=\"onPrev()\"\r\n            (onNext)=\"onNext()\"\r\n            >\r\n        </popup>\r\n        <img *ngIf=\"needGoTop\" (click)=\"goTop()\" class=\"goTop\" src=\"./img/up.png\"/>\r\n        <img *ngIf=\"needMoreImg\" id=\"load\" src=\"./img/loading.gif\" width=\"50px\" height=\"50px\" alt=\"\" />\r\n    `\r\n})\r\nexport class GalleryComponent implements OnInit {\r\n\r\n\r\n    protected images: {}[] = [];\r\n    protected allImg: {}[];\r\n    protected scrollImg: number = 12;\r\n\r\n    private needMoreImg: boolean = true;\r\n    private watching: boolean;\r\n    private haveNext: boolean = true;\r\n    private havePrev: boolean = true;\r\n    private needGoTop: boolean = false;\r\n    private watchingId: number;\r\n\r\n    public selectedImg: {};\r\n\r\n\r\n    constructor(private _img:galleryService) {\r\n\r\n        _img.getImg().then((data) =>  {\r\n\r\n            this.allImg = data;\r\n\r\n            for (let i = 0; i < this.scrollImg; i++)\r\n                this.images.push(this.allImg[i]);\r\n\r\n            for (let i = 0; i < this.scrollImg; i++)\r\n                this.allImg.shift();\r\n\r\n        });\r\n\r\n\r\n    }\r\n\r\n    ngOnInit() {\r\n\r\n        window.addEventListener('scroll',() => {\r\n\r\n            (document.body.scrollTop > 400) ? this.needGoTop = true : this.needGoTop = false;\r\n\r\n            if (window.screen.height + document.body.scrollTop > document.body.clientHeight)\r\n\r\n                if (this.needMoreImg) this.addImgInPage();\r\n\r\n        });\r\n\r\n    }\r\n\r\n    addImgInPage() {\r\n\r\n        let j = (this.allImg.length < this.scrollImg) ? this.allImg.length: this.scrollImg;\r\n\r\n        for (let i = 0; i < j; i++)\r\n            this.images.push(this.allImg[i]);\r\n\r\n        for (let i = 0; i < j; i++)\r\n            this.allImg.shift();\r\n\r\n        if (this.allImg.length===0) this.needMoreImg = false;\r\n\r\n    }\r\n\r\n    selectPhoto(index:number) {\r\n\r\n        (index===0) ? this.havePrev = false: this.havePrev = true;\r\n\r\n        (index+1===this.images.length) ? this.haveNext = false: this.haveNext = true;\r\n\r\n        this.watching = true;\r\n        this.watchingId = index;\r\n        this.selectedImg = this.images[index];\r\n\r\n    }\r\n\r\n    onPrev () {\r\n\r\n        if (!this.haveNext) this.haveNext = true;\r\n\r\n        if (this.watchingId!==0) {\r\n\r\n            this.watchingId--;\r\n            this.selectedImg = this.images[this.watchingId];\r\n            (this.watchingId === 0) ? this.havePrev = false : this.havePrev = true;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    onNext () {\r\n\r\n        if (!this.havePrev) this.havePrev = true;\r\n\r\n        if (this.images.length-1!==this.watchingId) {\r\n\r\n            this.watchingId++;\r\n            this.selectedImg = this.images[this.watchingId];\r\n            if(this.watchingId === this.images.length-1) this.haveNext = false;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    onClose () {\r\n\r\n        this.watching = false;\r\n        this.selectedImg = {};\r\n\r\n    }\r\n\r\n    goTop () {\r\n\r\n        window.scrollTo(0,0);\r\n\r\n    }\r\n\r\n}"]}